## Как запустить проект

Скачать репозиторий

```sh
git clone git@github.com:Corwin74/avito.git
```

Подготовка системы:

Убедитесь, что у вас установлен Docker и Docker Compose
Проверьте, что порты 8080 не заняты другими приложениями.

## Сборка и запуск контейнеров
Выполните сборку приложения командой 

```sh
docker compose up --build
```

## Для запуска в фоновом режиме используйте
```bash
docker compose up -d --build
```

Сервис будет доступен на порту 8080


## Юнит-тесты
```sh
docker compose exec avito-shop go test -v -cover shop/internal/usecase/user
```

## Интеграционные тесты

```bash
docker compose exec avito-shop go test -v shop/integration/merch
```
```bash
docker compose exec avito-shop go test -v shop/integration/sendcoin
```

Интеграционные тесты проверяеют все основные сценарии:

- Создание нового пользователя и выдача ему токена
- Авторизация по токену при выполнении запросов
- Перевод монет от одного пользователя другому
- Покупка предмета
- Проверка корректности баланса пользователя и наличии предметов в инвентаре.

Таким образом тесты проверяют все ручки:
- /api/info
- /api/sendCoin
- /api/buy/{item}
- /api/auth

## Замечания по проекту

Метод GET для покупки предмета противоречит философии REST API поскольку GET запросы должны быть идемпотентными и не должны изменять состояние на сервере. А у нас получается меняется количество монет и количество предметов у пользователя. Логичней здесь использовать метод POST.

Генeрация JWT токенов для пользователя получилось затратной по времени операцией. При использовании bcrypt большинство запросов выходило за 50 мс. Заменил на Agron2 с возможностью работы в нескольких потоках, ситуация улучшилась, но иногда выходила за лимит времени. Возможно здесь необходимо использовать менее затратную криптографию.
